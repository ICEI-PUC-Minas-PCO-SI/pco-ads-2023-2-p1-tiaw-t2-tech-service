$(document).ready(function () {
  let novoTitulo = "";
  let novaDescricao = "";
  let novoServico = {
    titulo: "",
    descricao: "",
  };
  let usuario = {
    nome: "",
    sobre: "",
    curriculo: "",
    portfolio: "",
    imagem: "",
    servicos: [],
  };

  $("#submit-usuario").click(function () {
    usuario.nome = $("#input-nome").val();
    usuario.sobre = $("#textarea-sobre").val();
    usuario.curriculo = $("#input-arquivo1").val();
    usuario.portfolio = $("#input-arquivo2").val();
    usuario.imagem = $("#input-img").val();
    do {
      if (usuario.nome === "") {
        $("#input-nome").css({
          border: "4px solid red",
        });
        $("#meuModal-Servico").modal("show");
        $(".modal-title-serv").css("color", "red").text("Aviso!!");
        $("#paragraph-modal-serv")
          .css({ color: "red", "font-size": "1.5rem" })
          .text("Insira o nome (OBRIGATÓRIO)");
        break;
      } else {
        $("#input-nome").css({
          border: "4px solid green",
          color: "green",
        });
      }
    } while (usuario.nome === "");
    setTimeout(function () {
      $("#input-nome").css({
        border: "",
        color: "",
      });
    }, 3000);

    if (usuario.sobre === "") {
      $("#textarea-sobre").css({
        border: "4px solid red",
        color: "red",
      });
    } else {
      $("#textarea-sobre").css({
        border: "4px solid green",
        color: "green",
      });
    }
    setTimeout(function () {
      $("#textarea-sobre").css({
        border: "",
        color: "",
      });
    }, 3000);

    if (usuario.curriculo === "") {
      $("#input-arquivo1").css({
        border: "4px solid red",
        color: "red",
      });
    } else {
      $("#input-arquivo1").css({
        border: "4px solid green",
        color: "green",
      });
    }
    setTimeout(function () {
      $("#input-arquivo1").css({
        border: "",
        color: "",
      });
    }, 3000);

    if (usuario.portfolio === "") {
      $("#input-arquivo2").css({
        border: "4px solid red",
        color: "red",
      });
    } else {
      $("#input-arquivo2").css({
        border: "4px solid green",
        color: "green",
      });
    }
    setTimeout(function () {
      $("#input-arquivo2").css({
        border: "",
        color: "",
      });
    }, 3000);

    if (usuario.imagem === "") {
      $("#input-img").css({
        border: "4px solid red",
        color: "red",
      });
    } else {
      $("#input-img").css({
        border: "4px solid green",
        color: "green",
      });
    }
    setTimeout(function () {
      $("#input-img").css({
        border: "",
        color: "",
      });
    }, 3000);

    if (usuario.nome !== "") {
      let algumCampoVazio = false;

      for (let chave in usuario) {
        if (usuario.hasOwnProperty(chave) && usuario[chave] === "") {
          algumCampoVazio = true;
          break; // Interrompe o loop ao encontrar o primeiro campo vazio
        }
      }

      if (algumCampoVazio) {
        $("#meuModal").modal("show");
        $("#paragraph-modal").text(
          "Alguns dados ainda não foram preenchidos. Deseja salvar mesmo assim?"
        );
      } else {
        $("#meuModal").modal("show");
        $("#paragraph-modal").text(
          "Todos os dados foram preenchidos. Deseja salvá-los?"
        );
      }
    }
    console.log(usuario);
  });

  $("#btn-seguir").click(function () {
    localStorage.setItem("usuario", JSON.stringify(usuario));
    setTimeout(function () {
      $("#meuModal").modal("hide");
      if (usuario.imagem == "") {
        $("#img-usuario").attr("src", "/src/imgs/avatarimg.png");
      } else {
        $("#img-usuario").attr("src", usuario.imagem);
      }
    }, 1000);

    $("input[type='text']").val("");
    $("input[type='text'], textarea").val("");
  });

  $("#input-serv").click(function (event) {
    event.preventDefault();
    let novoTitulo = $("#titulo-serv").val();
    let novaDescricao = $("#descricao-serv").val();

    if (novoTitulo == "" || novaDescricao == "") {
      $("#meuModal-Servico").modal("show");
      $(".modal-title-serv").css("color", "red").text("Aviso!!");
      $("#paragraph-modal-serv")
        .css({ color: "red", "font-size": "1.5rem" })
        .text("Insira todos os dados");
    } else {
      if (usuario.servicos.length <= 4) {
        usuario.servicos.push({
          titulo: novoTitulo,
          descricao: novaDescricao,
        });

        $("#meuModal-Servico").modal("show");
        $(".modal-title-serv").css("color", "green").text("Sucesso");
        $("#paragraph-modal-serv")
          .css({ color: "green", "font-size": "1rem" })
          .text("Enviado ");

        setTimeout(function () {
          $(".dados-servicos input[type= 'text'], textarea").val("");
        }, 3000);
      } else {
        $("#meuModal-Servico").modal("show");
        $(".modal-title-serv").css("color", "red").text("Aviso!!");
        $("#paragraph-modal-serv")
          .css("color", "red")
          .text("Você execedeu a quantidade maxima de Serviços (4) ");
      }
      localStorage.setItem("usuario", JSON.stringify(usuario));
    }
  });
});
